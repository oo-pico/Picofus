<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Picofus ‚Äì Tracker</title>

  <!-- Favicon simple "P" -->
  <link rel="icon" type="image/svg+xml"
    href='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1"><stop stop-color="%23d6b36a" stop-opacity=".9"/><stop stop-color="%23d6b36a" stop-opacity=".15"/></linearGradient></defs><rect x="6" y="6" width="52" height="52" rx="16" fill="url(%23g)" stroke="%23d6b36a" stroke-opacity=".55"/><text x="32" y="41" font-size="30" text-anchor="middle" font-family="system-ui" font-weight="800" fill="%23d6b36a">P</text></svg>'>

  <style>
    :root{
      --bg:#0e0e0f; --panel:#151517; --panel-soft:#1b1b1e; --stroke:#26262a;
      --text:#e6e6e6; --muted:#9a9a9a; --gold:#d6b36a; --gold-soft:#b89a55;
      --bad:#ff4d4d; --good:#45d07a; --shadow:0 12px 30px rgba(0,0,0,.35);
      --r:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;
      background:
        radial-gradient(1200px 600px at 30% -10%, rgba(214,179,106,.08), transparent 60%),
        radial-gradient(900px 500px at 110% 10%, rgba(214,179,106,.06), transparent 55%),
        var(--bg);
      color:var(--text);
      min-height:100vh;
    }
    .wrap{max-width:1180px;margin:0 auto;padding:18px}
    header{
      display:flex;align-items:center;justify-content:space-between;gap:14px;
      padding:14px 14px;border:1px solid var(--stroke);border-radius:var(--r);
      background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.015));
      box-shadow:var(--shadow);
      position:sticky;top:10px;z-index:40;backdrop-filter:blur(10px);
    }
    .brand{display:flex;align-items:center;gap:12px;min-width:0}
    .logo{
      width:38px;height:38px;border-radius:12px;
      background:linear-gradient(135deg, rgba(214,179,106,.35), rgba(214,179,106,.05));
      border:1px solid rgba(214,179,106,.35);
      display:grid;place-items:center;
      font-weight:900;color:var(--gold);font-size:18px;
      flex:0 0 auto;
    }
    .brand h1{font-size:15px;margin:0;line-height:1}
    .brand p{margin:3px 0 0;color:var(--muted);font-size:12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .nav{display:flex;gap:8px;align-items:center;flex-wrap:wrap;justify-content:flex-end}
    .pill{
      font-size:12px;color:var(--muted);
      border:1px solid var(--stroke);background:rgba(255,255,255,.02);
      padding:7px 10px;border-radius:999px;
      display:inline-flex;align-items:center;gap:8px;
      max-width:360px;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .btn{
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.03);
      color:var(--text);
      border-radius:14px;
      padding:10px 12px;
      cursor:pointer;
      display:inline-flex;align-items:center;gap:8px;
      transition:transform .08s ease, border-color .15s ease, background .15s ease;
      user-select:none;
      font-size:13px;
      line-height:1;
    }
    .btn:hover{border-color:rgba(214,179,106,.45);background:rgba(214,179,106,.07)}
    .btn:active{transform:translateY(1px)}
    .btn.small{padding:8px 10px;border-radius:12px;font-size:13px}
    .btn.gold{border-color:rgba(214,179,106,.55);background:rgba(214,179,106,.08)}
    .btn.good{border-color:rgba(69,208,122,.5);background:rgba(69,208,122,.08)}
    .btn.bad{border-color:rgba(255,77,77,.5);background:rgba(255,77,77,.08)}
    .btn.active{border-color:rgba(214,179,106,.75);background:rgba(214,179,106,.15);font-weight:700}

    .navIcon{width:18px;height:18px;object-fit:contain;display:block}
    .ppIcon{width:22px;height:22px;object-fit:contain;display:block}

    .kamasIcon{width:14px;height:14px;object-fit:contain;display:block;opacity:.95}
    .kamasInline{display:inline-flex;gap:6px;align-items:center;vertical-align:middle}

    main{padding-top:16px}

    .grid{display:grid;grid-template-columns:repeat(3, minmax(0, 1fr));gap:12px;}
    @media (max-width: 980px){ .grid{grid-template-columns:repeat(2, minmax(0, 1fr))} }
    @media (max-width: 620px){ .grid{grid-template-columns:1fr} }

    .card{
      border:1px solid var(--stroke);
      background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.015));
      border-radius:var(--r);
      box-shadow:var(--shadow);
      padding:14px;
      display:flex;gap:14px;align-items:center;justify-content:space-between;
      min-height:86px;
    }
    .card-left{display:flex;gap:12px;align-items:center;min-width:0}
    .thumb{
      width:54px;height:54px;border-radius:16px;
      border:1px solid rgba(214,179,106,.25);
      background:rgba(214,179,106,.06);
      display:grid;place-items:center;overflow:hidden;
      flex:0 0 auto;
    }
    .thumb img{width:100%;height:100%;object-fit:contain}
    .card h3{margin:0;font-size:15px}
    .card p{margin:3px 0 0;color:var(--muted);font-size:12px}

    .section{
      border:1px solid var(--stroke);
      background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.015));
      border-radius:var(--r);
      box-shadow:var(--shadow);
      padding:14px;
      margin-bottom:12px;
    }
    .topline{display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:space-between;margin-bottom:12px;}
    .title{display:flex;gap:12px;align-items:center;min-width:0;}
    .title h2{margin:0;font-size:18px}
    .title .sub{margin:0;color:var(--muted);font-size:12px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
    @media (max-width: 980px){ .row{grid-template-columns:1fr} }

    .list{display:flex;flex-direction:column;gap:10px}

    .equipGrid{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:10px;
    }
    @media (max-width: 980px){ .equipGrid{grid-template-columns:1fr} }

    .item{
      display:grid;
      grid-template-columns:42px 1fr auto;
      gap:10px;align-items:center;
      padding:10px;
      border:1px solid var(--stroke);
      border-radius:16px;
      background:rgba(255,255,255,.02);
    }
    .ico{
      width:42px;height:42px;border-radius:14px;
      border:1px solid rgba(214,179,106,.18);
      background:rgba(214,179,106,.05);
      display:grid;place-items:center;overflow:hidden;
    }
    .ico img{width:100%;height:100%;object-fit:contain}
    .name{min-width:0}
    .name .n{font-size:14px;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .name .m{font-size:12px;margin:2px 0 0;color:var(--muted)}
    .ctrls{display:flex;gap:8px;align-items:center;flex-wrap:wrap;justify-content:flex-end}
    .num{
      min-width:72px;text-align:right;
      font-variant-numeric:tabular-nums;
      font-weight:800;
      padding:8px 10px;border-radius:12px;
      border:1px solid var(--stroke);
      background:rgba(0,0,0,.18);
      cursor:pointer;
    }
    .num:hover{border-color:rgba(214,179,106,.4)}
    .price{
      width:120px;
      padding:8px 10px;border-radius:12px;
      border:1px solid var(--stroke);
      background:rgba(0,0,0,.18);
      color:var(--text);
      outline:none;
      font-variant-numeric:tabular-nums;
      text-align:right;
    }
    .price:focus{border-color:rgba(214,179,106,.55)}
    .mono{font-variant-numeric:tabular-nums}

    .summary{display:grid;grid-template-columns:repeat(4, minmax(0, 1fr));gap:10px;margin-top:12px;}
    @media (max-width: 980px){ .summary{grid-template-columns:repeat(2, minmax(0, 1fr))} }
    .kpi{border:1px solid var(--stroke);border-radius:16px;background:rgba(255,255,255,.02);padding:10px;}
    .kpi .k{font-size:12px;color:var(--muted);display:flex;gap:8px;align-items:center}
    .kpi .v{margin-top:6px;font-size:16px;font-weight:900;font-variant-numeric:tabular-nums}
    .kpi .v.gold{color:var(--gold)}
    .hint{margin-top:10px;color:var(--muted);font-size:12px;line-height:1.35}

    .butinSelector{display:flex;gap:8px;margin-bottom:10px;flex-wrap:wrap;align-items:center}
    .butinLabel{font-size:12px;color:var(--muted);text-transform:uppercase;letter-spacing:0.06em}

    .modal{position:fixed;inset:0;background:rgba(0,0,0,.72);display:none;align-items:center;justify-content:center;padding:18px;z-index:99;}
    .modal.open{display:flex}
    .kbd{
      width:min(420px, 100%);
      border:1px solid var(--stroke);
      border-radius:22px;
      background:linear-gradient(180deg, #1b1b1e, #121214);
      box-shadow:0 25px 60px rgba(0,0,0,.75);
      padding:14px;
    }
    .kbd-top{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:10px}
    .kbd-top .label{color:var(--muted);font-size:12px}
    .kbd-top .target{font-weight:900}
    .kbd-display{
      border:1px solid var(--stroke);
      background:#0b0b0c;
      border-radius:18px;
      padding:12px 12px;
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      margin-bottom:12px;
    }
    .kbd-display .val{font-size:22px;font-weight:950;font-variant-numeric:tabular-nums;user-select:all}
    .kbd-grid{display:grid;grid-template-columns:repeat(3, 1fr);gap:10px;}
    .kbd-key{
      border:1px solid var(--stroke);
      background:#18181a;
      color:var(--text);
      border-radius:16px;
      padding:14px 10px;
      font-size:16px;
      cursor:pointer;
      user-select:none;
    }
    .kbd-key:hover{border-color:rgba(214,179,106,.45);background:#1f1f22}
    .kbd-key:active{transform:scale(0.97)}
    .kbd-actions{display:flex;gap:10px;margin-top:12px;flex-wrap:wrap}
    .kbd-actions .btn{flex:1}

    .intGrid{
      display:grid;
      grid-template-columns:repeat(3, 1fr);
      gap:10px;
      margin-top:10px;
    }
    @media (max-width: 420px){ .intGrid{grid-template-columns:repeat(2, 1fr)} }
    .intBtn{
      border:1px solid var(--stroke);
      background:#18181a;
      color:var(--text);
      border-radius:16px;
      padding:10px;
      cursor:pointer;
      display:flex;align-items:center;gap:10px;
      transition:transform .08s ease, border-color .15s ease, background .15s ease;
    }
    .intBtn:hover{border-color:rgba(214,179,106,.45);background:#1f1f22}
    .intBtn:active{transform:scale(.985)}
    .intBtn .i{width:34px;height:34px;border-radius:12px;border:1px solid rgba(214,179,106,.18);background:rgba(214,179,106,.05);display:grid;place-items:center;overflow:hidden;flex:0 0 auto}
    .intBtn .i img{width:100%;height:100%;object-fit:contain}
    .intBtn .t{min-width:0}
    .intBtn .t .n{margin:0;font-size:13px;font-weight:900}
    .intBtn .t .s{margin:2px 0 0;color:var(--muted);font-size:12px}

    .miniLegendGrid{
      display:grid;
      grid-template-columns:repeat(auto-fill, minmax(120px, 1fr));
      gap:8px;
    }
    .miniLegend{
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.02);
      border-radius:14px;
      padding:8px;
      display:flex;align-items:center;justify-content:space-between;gap:8px;
    }
    .miniLegend .left{display:flex;align-items:center;gap:8px;min-width:0}
    .miniLegend .ico{
      width:34px;height:34px;border-radius:12px;
      flex:0 0 auto;
    }
    .miniLegend .lab{
      min-width:0;
      font-size:12px;
      color:var(--muted);
      white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
      max-width:120px;
    }
    .miniLegend .ctrls{gap:6px}
    .miniLegend .num{min-width:54px;padding:7px 8px;border-radius:10px}

    .statGrid{
      display:grid;
      grid-template-columns:repeat(auto-fill, minmax(220px, 1fr));
      gap:10px;
    }
    .statItem{
      border:1px solid var(--stroke);
      border-radius:14px;
      background:rgba(255,255,255,.02);
      padding:10px;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .statItem .ico{width:36px;height:36px;border-radius:12px;flex-shrink:0}
    .statItem .info{min-width:0;flex:1}
    .statItem .info .n{font-size:13px;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .statItem .info .v{font-size:14px;font-weight:900;margin:2px 0 0;font-variant-numeric:tabular-nums;color:var(--gold)}
    .statItem .right{font-variant-numeric:tabular-nums;font-weight:900}

    /* TOP RESSOURCES */
    .topResWrap{display:flex;flex-direction:column;gap:10px}
    .topResHero{
      border:1px solid rgba(214,179,106,.35);
      background:linear-gradient(180deg, rgba(214,179,106,.12), rgba(255,255,255,.015));
      border-radius:18px;
      padding:12px;
      display:flex;align-items:center;justify-content:space-between;gap:12px;
    }
    .topResHero .L{display:flex;align-items:center;gap:12px;min-width:0}
    .topResHero .ico{width:48px;height:48px;border-radius:16px}
    .topResHero .name{min-width:0}
    .topResHero .name .n{margin:0;font-size:14px;font-weight:950;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .topResHero .name .m{margin:2px 0 0;color:var(--muted);font-size:12px}
    .topResHero .price{font-weight:950}
    .topResRow{
      display:grid;
      grid-template-columns:repeat(auto-fill, minmax(150px, 1fr));
      gap:10px;
    }
    .topResMini{
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.02);
      border-radius:16px;
      padding:10px;
      display:flex;flex-direction:column;gap:8px;
      align-items:flex-start;
    }
    .topResMini .ico{width:40px;height:40px;border-radius:14px}
    .topResMini .p{font-weight:950}

    /* ‚úÖ Omega: XP totale plus large */
    .omegaSummary .kpi:first-child{ grid-column: 1 / -1; }
    @media (max-width: 980px){
      .omegaSummary .kpi:first-child{ grid-column: 1 / -1; }
    }

    /* ===== FIX Modal Bribes (intensit√©s) : ic√¥nes ne d√©bordent plus ===== */
    #modalIntensity .kbd{ width:min(520px,100%); }
    #modalIntensity .intBtn{ min-height:64px; padding:12px; align-items:center; }
    #modalIntensity .intBtn .i{ width:42px; height:42px; border-radius:14px; overflow:hidden; }
    #modalIntensity .intBtn .i img{ width:100%; height:100%; object-fit:contain; display:block; }

    /* ===== Mini carr√©s l√©gendes : + en haut, - en bas ===== */
    .miniLegend .ctrls{ display:flex; flex-direction:column; gap:6px; align-items:stretch; }
    .miniLegend .num{ min-width:auto; width:100%; text-align:center; }

    /* ===== Stats : mini pictos l√©gendes dropp√©es ===== */
    .legendPreview{ margin-top:8px; display:flex; gap:6px; flex-wrap:wrap; }
    .legendPreview img{
      width:18px;height:18px;object-fit:contain;border-radius:6px;
      border:1px solid var(--stroke); background:rgba(0,0,0,.18); padding:2px;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo">P</div>
        <div style="min-width:0">
          <h1>Picofus ‚Äì Tracker</h1>
          <p>Donjons ‚Ä¢ Songes ‚Ä¢ Stats ‚Ä¢ PP ‚Ä¢ Om√©ga</p>
        </div>
      </div>

      <div class="nav">
        <span class="pill" id="pagePill">Accueil</span>

        <button class="btn small" id="btnHome" title="Accueil">
          <img class="navIcon" src="./Maison.png" alt="Accueil">
        </button>

        <button class="btn small" id="btnDonjons" title="Donjons">
          <img class="navIcon" src="./Ic%C3%B4ne%20Dj.png" alt="Donjons">
        </button>

        <button class="btn small" id="btnSonges" title="Songes">
          <img class="navIcon" src="./Baguette%20Range.png" alt="Songes">
        </button>

        <button class="btn small" id="btnStats" title="Stats">
          <img class="navIcon" src="./Carac.png" alt="Stats">
        </button>

        <button class="btn small" id="btnPP" title="Calcul PP">
          <img class="navIcon" src="./Ic%C3%B4ne%20Calculateur%20PP.png" alt="PP">
        </button>

        <button class="btn small" id="btnOmega" title="Om√©ga">üìà</button>

        <button class="btn small bad" id="btnResetAll" title="Reset tout">üßπ Reset</button>
      </div>
    </header>

    <main id="app"></main>
  </div>

  <!-- Keypad modal -->
  <div class="modal" id="modal">
    <div class="kbd" role="dialog" aria-modal="true">
      <div class="kbd-top">
        <div>
          <div class="label">Pav√© num√©rique</div>
          <div class="target" id="kbdTarget">‚Äî</div>
        </div>
        <button class="btn small" id="kbdClose">‚úñ</button>
      </div>

      <div class="kbd-display">
        <div class="label">Valeur</div>
        <div class="val mono" id="kbdValue">0</div>
      </div>

      <div class="kbd-grid" id="kbdGrid"></div>

      <div class="kbd-actions">
        <button class="btn bad" id="kbdClear">C</button>
        <button class="btn" id="kbdBack">‚å´</button>
        <button class="btn gold" id="kbdOk">‚úì Valider</button>
      </div>

      <div class="hint">
        Clavier : chiffres 0-9 ‚Ä¢ C ou Suppr/Delete = effacer ‚Ä¢ Backspace = retour ‚Ä¢ Entr√©e = valider ‚Ä¢ √âchap = fermer
      </div>
    </div>
  </div>

  <!-- ‚úÖ Intensity modal (Bribes) -->
  <div class="modal" id="modalIntensity">
    <div class="kbd" role="dialog" aria-modal="true">
      <div class="kbd-top">
        <div>
          <div class="label">Bribes</div>
          <div class="target" id="intTitle">Choisir l‚Äôintensit√©</div>
        </div>
        <button class="btn small" id="intClose">‚úñ</button>
      </div>

      <div class="kbd-display">
        <div class="label">Quantit√©</div>
        <div class="val mono" id="intQty">0</div>
      </div>

      <div class="intGrid" id="intGrid"></div>

      <div class="kbd-actions">
        <button class="btn bad" id="intCancel">Annuler</button>
      </div>

      <div class="hint">
        Tu valides la quantit√© ‚Üí tu choisis l‚Äôintensit√© ‚Üí √ßa s‚Äôajoute au bon compteur.
      </div>
    </div>
  </div>

<script>
/* NOTE:
   Le fichier original est tr√®s long (donn√©es donjons, etc.).
   Pour √©viter tout risque de tronquage dans l'outil, je vais √©crire une version patch√©e via les remplacements cibl√©s.
   Si tu veux absolument tout le HTML complet dans le chat, je te le fournis en plusieurs messages. */
</script>
</body>
</html>
